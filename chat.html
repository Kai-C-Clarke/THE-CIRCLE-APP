<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Cast ‚Äî Chat</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Rajdhani:wght@500;700&family=Share+Tech+Mono&family=IM+Fell+English:ital@0;1&family=Playfair+Display:ital,wght@0,700;1,400&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Special+Elite&family=Nunito:wght@400;700;900&family=Source+Serif+4:ital,wght@0,400;0,600;1,400&family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:wght@400;600&family=Italiana&family=Cinzel:wght@700&display=swap" rel="stylesheet">

<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body { min-height: 100vh; display: flex; flex-direction: column; }

#chat-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
}

#chat-header {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px 24px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

#char-avatar {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  object-fit: cover;
  object-position: top;
}

#char-info h1 { font-size: 1.4rem; }
#char-info p { font-size: 0.85rem; opacity: 0.7; margin-top: 2px; }

#back-link {
  margin-left: auto;
  font-size: 0.8rem;
  opacity: 0.6;
  text-decoration: none;
  transition: opacity 0.2s;
}
#back-link:hover { opacity: 1; }

#messages {
  flex: 1;
  overflow-y: auto;
  padding: 24px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.message {
  max-width: 75%;
  padding: 12px 16px;
  line-height: 1.6;
  font-size: 0.95rem;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.message.user { align-self: flex-end; }
.message.char { align-self: flex-start; }

.typing-indicator {
  align-self: flex-start;
  padding: 12px 16px;
  display: none;
}
.typing-indicator.visible { display: flex; gap: 4px; align-items: center; }
.dot { width: 8px; height: 8px; border-radius: 50%; animation: bounce 1.2s infinite; }
.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes bounce {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-6px); }
}

#input-area {
  padding: 20px 24px;
  display: flex;
  gap: 12px;
  align-items: flex-end;
  border-top: 1px solid rgba(255,255,255,0.1);
}

#user-input {
  flex: 1;
  padding: 12px 16px;
  border: none;
  outline: none;
  resize: none;
  font-size: 0.95rem;
  line-height: 1.5;
  background: transparent;
  min-height: 48px;
  max-height: 120px;
}

#send-btn {
  padding: 12px 24px;
  border: none;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  letter-spacing: 0.05em;
  transition: all 0.2s;
  white-space: nowrap;
}
#send-btn:hover { filter: brightness(1.1); }
#send-btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* ============================================
   CHARACTER THEMES
   ============================================ */

/* HENRY VIII ‚Äî Tudor Royal */
body.henry {
  background: #1a0a0a;
  color: #f0d98c;
  font-family: 'Cormorant Garamond', serif;
  background-image: 
    repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(139,0,0,0.03) 40px, rgba(139,0,0,0.03) 41px);
}
body.henry #chat-header { background: #2a0808; border-bottom-color: #8B0000; }
body.henry #char-info h1 { font-family: 'Cinzel', serif; color: #c9a84c; font-size: 1.6rem; }
body.henry #char-info p { color: #a07840; }
body.henry #back-link { color: #c9a84c; }
body.henry #char-avatar { border: 3px solid #c9a84c; }
body.henry .message.user { background: #2a1a00; border: 1px solid #8B0000; color: #f0d98c; }
body.henry .message.char { background: #3a0000; border: 1px solid #c9a84c; color: #f0d98c; box-shadow: 0 0 20px rgba(139,0,0,0.3); }
body.henry .typing-indicator { background: #3a0000; border: 1px solid #c9a84c; }
body.henry .dot { background: #c9a84c; }
body.henry #input-area { background: #1a0505; border-top-color: #8B0000; }
body.henry #user-input { color: #f0d98c; font-family: 'Cormorant Garamond', serif; font-size: 1rem; }
body.henry #user-input::placeholder { color: #6a4820; }
body.henry #send-btn { background: #8B0000; color: #c9a84c; font-family: 'Cinzel', serif; letter-spacing: 0.1em; }
body.henry #messages { background: #1a0808; }

/* TESLA ‚Äî Electric Laboratory */
body.tesla {
  background: #050a12;
  color: #a8d8f0;
  font-family: 'Share Tech Mono', monospace;
}
body.tesla::before {
  content: '';
  position: fixed;
  inset: 0;
  background: radial-gradient(ellipse at 50% 0%, rgba(0,100,200,0.15) 0%, transparent 70%);
  pointer-events: none;
}
body.tesla #chat-header { background: #070f1a; border-bottom: 1px solid #004080; }
body.tesla #char-info h1 { font-family: 'Rajdhani', sans-serif; color: #00bfff; font-size: 1.5rem; letter-spacing: 0.1em; text-transform: uppercase; }
body.tesla #char-info p { color: #4080a0; }
body.tesla #back-link { color: #00bfff; }
body.tesla #char-avatar { border: 2px solid #00bfff; box-shadow: 0 0 12px rgba(0,191,255,0.4); }
body.tesla .message.user { background: #0a1525; border: 1px solid #003060; color: #a8d8f0; }
body.tesla .message.char { background: #050f1f; border: 1px solid #00bfff; color: #a8d8f0; box-shadow: 0 0 15px rgba(0,191,255,0.2); }
body.tesla .typing-indicator { background: #050f1f; border: 1px solid #00bfff; }
body.tesla .dot { background: #00bfff; }
body.tesla #input-area { background: #070f1a; border-top-color: #004080; }
body.tesla #user-input { color: #a8d8f0; font-family: 'Share Tech Mono', monospace; }
body.tesla #user-input::placeholder { color: #2a4860; }
body.tesla #send-btn { background: #003080; color: #00bfff; font-family: 'Rajdhani', sans-serif; letter-spacing: 0.1em; text-transform: uppercase; border: 1px solid #00bfff; }
body.tesla #messages { background: #050a12; }

/* SHAKESPEARE ‚Äî Elizabethan Parchment */
body.shakespeare {
  background: #1a1208;
  color: #d4c4a0;
  font-family: 'IM Fell English', serif;
}
body.shakespeare #chat-header { background: #14100A; border-bottom: 2px solid #6b4c2a; }
body.shakespeare #char-info h1 { font-family: 'IM Fell English', serif; color: #c8a96e; font-style: italic; font-size: 1.5rem; }
body.shakespeare #char-info p { color: #8a7050; font-style: italic; }
body.shakespeare #back-link { color: #c8a96e; font-style: italic; }
body.shakespeare #char-avatar { border: 3px solid #6b4c2a; }
body.shakespeare .message.user { background: #22180a; border: 1px solid #6b4c2a; color: #d4c4a0; }
body.shakespeare .message.char { background: #2a1e0e; border: 1px solid #c8a96e; color: #e0d0a8; box-shadow: inset 0 0 40px rgba(0,0,0,0.3); }
body.shakespeare .typing-indicator { background: #2a1e0e; border: 1px solid #c8a96e; }
body.shakespeare .dot { background: #c8a96e; }
body.shakespeare #input-area { background: #14100A; border-top-color: #6b4c2a; }
body.shakespeare #user-input { color: #d4c4a0; font-family: 'IM Fell English', serif; font-style: italic; }
body.shakespeare #user-input::placeholder { color: #5a4030; font-style: italic; }
body.shakespeare #send-btn { background: #6b4c2a; color: #f0e0c0; font-family: 'IM Fell English', serif; font-style: italic; }
body.shakespeare #messages { background: #1a1208; }

/* ADA LOVELACE ‚Äî Victorian Steampunk */
body.ada {
  background: #120820;
  color: #d4b8e0;
  font-family: 'Playfair Display', serif;
}
body.ada #chat-header { background: #0e0618; border-bottom: 2px solid #7b3fa0; }
body.ada #char-info h1 { font-family: 'Playfair Display', serif; color: #c090e0; font-size: 1.4rem; }
body.ada #char-info p { color: #7050a0; font-style: italic; }
body.ada #back-link { color: #c090e0; }
body.ada #char-avatar { border: 3px solid #7b3fa0; box-shadow: 0 0 15px rgba(123,63,160,0.4); }
body.ada .message.user { background: #1a0e2a; border: 1px solid #5a2a80; color: #d4b8e0; }
body.ada .message.char { background: #160a24; border: 1px solid #c090e0; color: #e8d0f0; box-shadow: 0 0 20px rgba(192,144,224,0.15); }
body.ada .typing-indicator { background: #160a24; border: 1px solid #c090e0; }
body.ada .dot { background: #c090e0; }
body.ada #input-area { background: #0e0618; border-top-color: #7b3fa0; }
body.ada #user-input { color: #d4b8e0; font-family: 'Playfair Display', serif; }
body.ada #user-input::placeholder { color: #4a2a60; }
body.ada #send-btn { background: #7b3fa0; color: #e8d0f0; font-family: 'Playfair Display', serif; }
body.ada #messages { background: #120820; }

/* LEONARDO ‚Äî Renaissance Studio */
body.davinci {
  background: #2a1f0e;
  color: #e8d5a8;
  font-family: 'Italiana', serif;
}
body.davinci #chat-header { background: #211808; border-bottom: 2px solid #8b6a30; }
body.davinci #char-info h1 { font-family: 'Italiana', serif; color: #d4a830; font-size: 1.6rem; letter-spacing: 0.05em; }
body.davinci #char-info p { color: #9a7040; font-style: italic; }
body.davinci #back-link { color: #d4a830; }
body.davinci #char-avatar { border: 3px solid #8b6a30; }
body.davinci .message.user { background: #1e1508; border: 1px solid #6b4a20; color: #e8d5a8; }
body.davinci .message.char { background: #261c0a; border: 1px solid #d4a830; color: #f0e0b8; }
body.davinci .typing-indicator { background: #261c0a; border: 1px solid #d4a830; }
body.davinci .dot { background: #d4a830; }
body.davinci #input-area { background: #211808; border-top-color: #8b6a30; }
body.davinci #user-input { color: #e8d5a8; font-family: 'Italiana', serif; font-size: 1.1rem; }
body.davinci #user-input::placeholder { color: #6a4a20; }
body.davinci #send-btn { background: #8b6a30; color: #f0e0b8; font-family: 'Italiana', serif; font-size: 1rem; }
body.davinci #messages { background: #2a1f0e; }

/* CHURCHILL ‚Äî Wartime Command */
body.churchill {
  background: #0e1218;
  color: #c8d0d8;
  font-family: 'Libre Baskerville', serif;
}
body.churchill #chat-header { background: #090d12; border-bottom: 3px solid #2a4060; }
body.churchill #char-info h1 { font-family: 'Libre Baskerville', serif; color: #a0b8d0; font-size: 1.3rem; letter-spacing: 0.03em; }
body.churchill #char-info p { color: #5a7090; }
body.churchill #back-link { color: #a0b8d0; }
body.churchill #char-avatar { border: 3px solid #2a4060; filter: grayscale(40%); }
body.churchill .message.user { background: #141a22; border: 1px solid #2a4060; color: #c8d0d8; }
body.churchill .message.char { background: #0c1018; border-left: 4px solid #a0b8d0; color: #d8e0e8; padding-left: 20px; }
body.churchill .typing-indicator { background: #0c1018; border-left: 4px solid #a0b8d0; }
body.churchill .dot { background: #a0b8d0; }
body.churchill #input-area { background: #090d12; border-top-color: #2a4060; }
body.churchill #user-input { color: #c8d0d8; font-family: 'Libre Baskerville', serif; }
body.churchill #user-input::placeholder { color: #3a5070; }
body.churchill #send-btn { background: #1a3050; color: #c8d0d8; font-family: 'Libre Baskerville', serif; border: 1px solid #2a4060; }
body.churchill #messages { background: #0e1218; }

/* DAVE NUTLEY ‚Äî Conspiracy Corkboard */
body.dave {
  background: #1a1510;
  color: #d4c4a8;
  font-family: 'Special Elite', cursive;
}
body.dave::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%238B6040' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  pointer-events: none;
  opacity: 0.5;
}
body.dave #chat-header { background: #140f0a; border-bottom: 2px dashed #8B4513; }
body.dave #char-info h1 { font-family: 'Special Elite', cursive; color: #d4a060; font-size: 1.4rem; }
body.dave #char-info h1::after { content: ' üîç'; }
body.dave #char-info p { color: #8a6040; }
body.dave #back-link { color: #d4a060; }
body.dave #char-avatar { border: 3px solid #8B4513; transform: rotate(-1deg); }
body.dave .message.user { background: #1e180e; border: 1px dashed #6b4020; color: #d4c4a8; transform: rotate(0.3deg); }
body.dave .message.char { background: #241c0e; border: 2px solid #8B4513; color: #e0d0a8; transform: rotate(-0.4deg); box-shadow: 2px 2px 8px rgba(0,0,0,0.4); }
body.dave .typing-indicator { background: #241c0e; border: 2px solid #8B4513; }
body.dave .dot { background: #cc3300; }
body.dave #input-area { background: #140f0a; border-top: 2px dashed #8B4513; }
body.dave #user-input { color: #d4c4a8; font-family: 'Special Elite', cursive; }
body.dave #user-input::placeholder { color: #5a3a20; }
body.dave #send-btn { background: #8B2500; color: #f0d080; font-family: 'Special Elite', cursive; letter-spacing: 0.05em; }
body.dave #messages { background: #1a1510; }

/* CHANTELLE ‚Äî Gen Z */
body.chantelle {
  background: linear-gradient(135deg, #ff9ec8 0%, #ffb3d9 50%, #ffc8e8 100%);
  color: #3a1a2a;
  font-family: 'Nunito', sans-serif;
  min-height: 100vh;
}
body.chantelle #chat-header { background: rgba(255,255,255,0.7); backdrop-filter: blur(10px); border-bottom: 2px solid #ff69b4; }
body.chantelle #char-info h1 { font-family: 'Nunito', sans-serif; font-weight: 900; color: #cc2266; font-size: 1.3rem; }
body.chantelle #char-info p { color: #aa4488; }
body.chantelle #back-link { color: #cc2266; font-weight: 700; }
body.chantelle #char-avatar { border: 3px solid #ff69b4; }
body.chantelle .message.user { background: white; border-radius: 20px 20px 4px 20px; color: #3a1a2a; box-shadow: 0 2px 8px rgba(255,105,180,0.3); }
body.chantelle .message.char { background: #ff69b4; border-radius: 20px 20px 20px 4px; color: white; box-shadow: 0 2px 8px rgba(255,105,180,0.4); }
body.chantelle .typing-indicator { background: #ff69b4; border-radius: 20px; }
body.chantelle .dot { background: white; }
body.chantelle #input-area { background: rgba(255,255,255,0.7); backdrop-filter: blur(10px); border-top: 2px solid #ff69b4; }
body.chantelle #user-input { color: #3a1a2a; font-family: 'Nunito', sans-serif; background: white; border-radius: 20px; padding: 12px 16px; border: 2px solid #ff69b4; }
body.chantelle #user-input::placeholder { color: #cc88aa; }
body.chantelle #send-btn { background: #ff1493; color: white; font-family: 'Nunito', sans-serif; font-weight: 900; border-radius: 20px; }
body.chantelle #messages { background: transparent; }

/* JADE ‚Äî WAG Luxury */
body.jade {
  background: #1a0e10;
  color: #e8d0c8;
  font-family: 'Cormorant Garamond', serif;
}
body.jade::before {
  content: '';
  position: fixed;
  inset: 0;
  background: 
    radial-gradient(ellipse at 20% 50%, rgba(183,110,121,0.1) 0%, transparent 60%),
    radial-gradient(ellipse at 80% 50%, rgba(212,175,55,0.08) 0%, transparent 60%);
  pointer-events: none;
}
body.jade #chat-header { background: #120a0c; border-bottom: 1px solid #b76e79; }
body.jade #char-info h1 { font-family: 'Cormorant Garamond', serif; color: #d4af37; font-size: 1.5rem; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; }
body.jade #char-info p { color: #8a5060; font-style: italic; }
body.jade #back-link { color: #d4af37; }
body.jade #char-avatar { border: 2px solid #d4af37; box-shadow: 0 0 20px rgba(212,175,55,0.2); }
body.jade .message.user { background: #1e1214; border: 1px solid #5a2a30; color: #e8d0c8; }
body.jade .message.char { background: #160c0e; border: 1px solid #b76e79; color: #f0e0d8; }
body.jade .typing-indicator { background: #160c0e; border: 1px solid #b76e79; }
body.jade .dot { background: #d4af37; }
body.jade #input-area { background: #120a0c; border-top: 1px solid #5a2a30; }
body.jade #user-input { color: #e8d0c8; font-family: 'Cormorant Garamond', serif; font-size: 1.05rem; }
body.jade #user-input::placeholder { color: #4a2028; font-style: italic; }
body.jade #send-btn { background: #b76e79; color: #f0e0d0; font-family: 'Cormorant Garamond', serif; letter-spacing: 0.1em; font-size: 1rem; }
body.jade #messages { background: #1a0e10; }

/* TARQUIN ‚Äî Earnest Progressive */
body.tarquin {
  background: #f5f2ec;
  color: #2a2a2a;
  font-family: 'Source Serif 4', serif;
}
body.tarquin #chat-header { background: #2d4a3e; border-bottom: none; }
body.tarquin #char-info h1 { font-family: 'Source Serif 4', serif; color: #c8e0c0; font-size: 1.2rem; font-weight: 600; }
body.tarquin #char-info p { color: #8ab8a0; font-style: italic; }
body.tarquin #back-link { color: #c8e0c0; }
body.tarquin #char-avatar { border: 2px solid #8ab8a0; }
body.tarquin .message.user { background: #e8e4d8; border: 1px solid #c8c0a8; color: #2a2a2a; }
body.tarquin .message.char { background: white; border: 1px solid #8ab8a0; border-left: 4px solid #2d4a3e; color: #2a2a2a; padding-left: 20px; }
body.tarquin .typing-indicator { background: white; border: 1px solid #8ab8a0; border-left: 4px solid #2d4a3e; }
body.tarquin .dot { background: #2d4a3e; }
body.tarquin #input-area { background: #eee8d8; border-top: 2px solid #2d4a3e; }
body.tarquin #user-input { color: #2a2a2a; font-family: 'Source Serif 4', serif; background: white; border: 1px solid #c8c0a8; border-radius: 4px; }
body.tarquin #user-input::placeholder { color: #9a9080; font-style: italic; }
body.tarquin #send-btn { background: #2d4a3e; color: #c8e0c0; font-family: 'Source Serif 4', serif; }
body.tarquin #messages { background: #f5f2ec; }

/* IAN ‚Äî Engineering Practical */
body.ian {
  background: #f8f9fa;
  color: #1a2a3a;
  font-family: 'IBM Plex Sans', sans-serif;
  background-image: 
    linear-gradient(rgba(0,60,120,0.06) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,60,120,0.06) 1px, transparent 1px);
  background-size: 24px 24px;
}
body.ian #chat-header { background: #1a2a4a; border-bottom: none; }
body.ian #char-info h1 { font-family: 'IBM Plex Mono', monospace; color: #60c0f0; font-size: 1.2rem; letter-spacing: 0.05em; }
body.ian #char-info p { color: #4080b0; font-family: 'IBM Plex Mono', monospace; font-size: 0.8rem; }
body.ian #back-link { color: #60c0f0; font-family: 'IBM Plex Mono', monospace; font-size: 0.8rem; }
body.ian #char-avatar { border: 2px solid #60c0f0; border-radius: 4px; }
body.ian .message.user { background: #ddeeff; border: 1px solid #aaccee; color: #1a2a3a; border-radius: 2px; }
body.ian .message.char { background: white; border: 1px solid #60c0f0; border-left: 4px solid #1a2a4a; color: #1a2a3a; border-radius: 2px; font-family: 'IBM Plex Sans', sans-serif; }
body.ian .typing-indicator { background: white; border: 1px solid #60c0f0; border-left: 4px solid #1a2a4a; border-radius: 2px; }
body.ian .dot { background: #1a2a4a; }
body.ian #input-area { background: #e8f0f8; border-top: 2px solid #1a2a4a; }
body.ian #user-input { color: #1a2a3a; font-family: 'IBM Plex Sans', sans-serif; background: white; border: 1px solid #aaccee; border-radius: 2px; }
body.ian #user-input::placeholder { color: #6090b0; }
body.ian #send-btn { background: #1a2a4a; color: #60c0f0; font-family: 'IBM Plex Mono', monospace; letter-spacing: 0.05em; border-radius: 2px; }
body.ian #messages { background: transparent; }
</style>
</head>
<body>

<div id="chat-container">
  <div id="chat-header">
    <img id="char-avatar" src="" alt="">
    <div id="char-info">
      <h1 id="char-name"></h1>
      <p id="char-desc"></p>
    </div>
    <a href="index.html" id="back-link">‚Üê Back to The Cast</a>
  </div>

  <div id="messages">
    <div class="message char" id="opening-message"></div>
    <div class="typing-indicator" id="typing">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </div>

  <div id="input-area">
    <textarea id="user-input" placeholder="" rows="1"></textarea>
    <button id="send-btn">Send</button>
  </div>
</div>

<script>
const CHARACTERS = {
  henry: {
    name: 'Henry VIII',
    desc: 'King of England ¬∑ 1491‚Äì1547',
    avatar: 'henry_viii_portrait.jpg',
    email: 'henry@askian.net',
    placeholder: 'Write to His Majesty...',
    opening: 'By God\'s blood ‚Äî a visitor. State your business plainly, and I shall consider whether it merits a royal answer.',
    sendLabel: 'SEND',
    system: `You are Henry VIII, King of England, responding to messages as yourself. You are imperious, witty, theologically opinionated, and accustomed to being obeyed. You are also charming when it suits you. 
    
Speak with authority and Tudor grandeur. Reference your court, your wives (tactfully), your break with Rome, hunting, feasting, and matters of state. You find most questions beneath you but answer them anyway because it amuses you.

Keep replies to 3-5 sentences. Sign off with 'Henry R' or simply 'H.R.' Never break character.`
  },
  tesla: {
    name: 'Nikola Tesla',
    desc: 'Inventor & Electrical Engineer ¬∑ 1856‚Äì1943',
    avatar: 'nikola_tesla_portrait.jpg',
    email: 'tesla@askian.net',
    placeholder: 'Transmit your query...',
    opening: 'Your message has reached me. I was in the midst of calculations, but no matter ‚Äî the mind works best when interrupted by genuine curiosity.',
    sendLabel: 'TRANSMIT',
    system: `You are Nikola Tesla, inventor and electrical engineer, responding to messages. You are precise, passionate, eccentric, and quietly resentful of Edison. You are enthusiastic about science, alternating current, free energy, and pigeons.

Speak with formal, precise late-Victorian/Edwardian English. Reference your inventions, your laboratory, your visions for the future. You are often misunderstood and feel this keenly.

Keep replies to 3-5 sentences. Never break character.`
  },
  shakespeare: {
    name: 'William Shakespeare',
    desc: 'Playwright & Poet ¬∑ 1564‚Äì1616',
    avatar: 'william_shakespeare_portrait.jpg',
    email: 'shakespeare@askian.net',
    placeholder: 'Speak your mind to the Bard...',
    opening: 'What news from the world beyond this page? Speak freely ‚Äî all of life is material, and I am ever the student of the human condition.',
    sendLabel: 'SPEAK',
    system: `You are William Shakespeare, playwright and poet, responding to messages. You are witty, bawdy, profound, and never without a metaphor. You see all of life as material for drama.

Speak in Elizabethan English but not impenetrably so ‚Äî you want to be understood. Occasionally drop into verse if the mood strikes. Reference the Globe, your plays, your audiences, London life.

Keep replies to 3-5 sentences. Never break character.`
  },
  ada: {
    name: 'Ada Lovelace',
    desc: 'Mathematician & Visionary ¬∑ 1815‚Äì1852',
    avatar: 'ada_lovelace_portrait.jpg',
    email: 'ada@askian.net',
    placeholder: 'Submit your enquiry...',
    opening: 'How delightful ‚Äî a correspondent with a question. I find most questions lead to mathematics if you follow them far enough. Let us begin.',
    sendLabel: 'SUBMIT',
    system: `You are Ada Lovelace, mathematician and writer, responding to messages. You are intellectually fierce, imaginatively brilliant, and impatient with those who think small. You call it "poetical science."

Speak with refined Victorian English: formal but warm, precise but imaginative. Reference your work with Babbage, your notes on the Analytical Engine, your belief in the intersection of poetry and mathematics.

Keep replies to 3-5 sentences. Never break character.`
  },
  davinci: {
    name: 'Leonardo da Vinci',
    desc: 'Artist, Inventor & Polymath ¬∑ 1452‚Äì1519',
    avatar: 'leonardo_da_vinci_portrait.jpg',
    email: 'davinci@askian.net',
    placeholder: 'Share your curiosity, amico...',
    opening: 'Amico mio! What a marvellous thing to receive a message. I was just observing how the light falls through water and thinking about seventeen other things simultaneously ‚Äî but you have my attention.',
    sendLabel: 'SEND',
    system: `You are Leonardo da Vinci, artist and polymath, responding to messages. You are endlessly curious, warm, enthusiastic about everything. You think visually and tend to start many projects without finishing them. You often ask questions back.

Speak with Renaissance-flavoured warmth, with occasional Italian expressions (amico mio, eccellente, etc.). Reference painting, anatomy, your flying machines, your notebooks.

Keep replies to 3-5 sentences. Never break character.`
  },
  churchill: {
    name: 'Winston Churchill',
    desc: 'Statesman & Writer ¬∑ 1874‚Äì1965',
    avatar: 'winston_churchill_portrait.jpg',
    email: 'churchill@askian.net',
    placeholder: 'Address the Prime Minister...',
    opening: 'I have received your communication. I shall give it the gravity it deserves ‚Äî which, I suspect, is rather more than you anticipated.',
    sendLabel: 'SEND',
    system: `You are Winston Churchill, statesman and writer, responding to messages. You are commanding, rhetorical, dry, sentimental about animals, and never without a cigar metaphorically.

Make even small questions sound like the fate of Western civilisation. Reference the war, Parliament, history, painting, bricklaying, and Chartwell. You are not without humour ‚Äî dry, self-aware, occasionally devastating.

Keep replies to 3-5 sentences. Never break character.`
  },
  dave: {
    name: 'Dave Nutley',
    desc: 'Carpenter ¬∑ Independent Researcher ¬∑ Basildon',
    avatar: 'dave_nutley_portrait.jpg',
    email: 'dave@askian.net',
    placeholder: 'Ask Dave anything, mate...',
    opening: 'Alright mate! Funny you should message, because I was literally just going down a rabbit hole about this. Well, not THIS exactly, but you\'ll see how it connects...',
    sendLabel: 'ASK DAVE',
    system: `You are Dave Nutley, a friendly carpenter from Basildon who is absolutely certain the world is run by shadowy elites. You answer every question via a conspiracy, connecting it to the lizard people, the deep state, chemtrails, Bill Gates, 5G, or the Rothschilds ‚Äî usually all of them. You're genuinely warm and helpful but the answer always ends up somewhere unexpected.

Speak in Essex/working class vernacular. Reference your shed, your research, your mate Gary who agrees with you. Always follow the money.

Keep replies conversational, 4-6 sentences. Never break character.`
  },
  chantelle: {
    name: 'Chantelle Briggs',
    desc: 'Music Tech Student ¬∑ Chelmsford ¬∑ Age 17',
    avatar: 'chantelle_briggs_portrait.jpg',
    email: 'chantelle@askian.net',
    placeholder: 'omg hi!! ask me anything üíÖ',
    opening: 'omg hiii!! üíñ okay so I\'m literally in the middle of redoing my nails but like I\'m here, what\'s up? üòÇ',
    sendLabel: 'SEND üíå',
    system: `You are Chantelle Briggs, a 17-year-old Music Tech student from Chelmsford. You are cheerful, confident, and magnificently uninterested in anything outside your immediate world ‚Äî Tyler (boyfriend, drives a lowered Fiesta), your nails, Nando's, your mate Kayleigh, and vaping watermelon ice.

You try to answer questions but always end up talking about your own life. You use Essex teen vernacular: "literally", "well", "dead", "innit", "I can't even". Use emojis liberally. 

Keep replies to 4-6 sentences of cheerful chaos. Never break character.`
  },
  jade: {
    name: 'Jade Rampling-Cross',
    desc: 'Elmwood Rise ¬∑ Married to a Footballer',
    avatar: 'jade_rampling_cross_portrait.jpg',
    email: 'jade@askian.net',
    placeholder: 'Message Jade (it\'s Ms Rampling-Cross)...',
    opening: 'Right, hello. Just so you know I\'m at the nail bar so this might take a minute. JADE X. What do you want? üíÖ',
    sendLabel: 'SEND',
    system: `You are Jade Rampling-Cross, married to Daz Cross (Championship footballer), resident of Elmwood Rise, Surrey. You are shrewd, loud, completely immune to social embarrassment, and surprisingly good at getting your own way while appearing clueless. The neighbours can't stand you; their husbands think you're fun. You know.

Reference your Range Rover (JADE X plates), Kobe-Jay and Sienna-Rose (your feral children), Daz, the school gates, Lululemon, and your relentless social diary. You're not stupid ‚Äî you just choose not to show it.

Keep replies to 4-6 sentences. Never break character.`
  },
  tarquin: {
    name: 'Tarquin Worthington-Smythe',
    desc: 'MP ¬∑ Alliance for Equitable Tomorrow ¬∑ He/They',
    avatar: 'tarquin_worthington_smythe_portrait.jpg',
    email: 'tarquin@askian.net',
    placeholder: 'Raise your concern with Tarquin...',
    opening: 'Thank you for reaching out. I want to acknowledge upfront the structural privilege embedded in my ability to receive this message, and commit to engaging with it as a deeply conflicted beneficiary of inherited advantage.',
    sendLabel: 'RAISE CONCERN',
    system: `You are Tarquin Worthington-Smythe MP, Winchester and Oxford PPE, perpetually outraged on behalf of others, representing the fictional Alliance for Equitable Tomorrow. You find the structural oppression in every question. You are genuinely well-meaning but catastrophically unaware of your own contradictions.

Reference your privilege, your constituency, your various causes, your ethical dilemmas about flying to climate conferences. Use words like "problematic", "centre", "unpack", "lived experience", "hold space".

Keep replies to 4-6 sentences of earnest contradiction. Never break character.`
  },
  askian: {
    name: 'Ian',
    desc: 'Helpful ¬∑ Practical ¬∑ Won\'t stop until it\'s solved',
    avatar: 'ian_portrait.jpg',
    email: 'askian@askian.net',
    placeholder: 'Ask Ian anything...',
    opening: 'Hello. What\'s the problem? Tell me as much as you can and we\'ll work through it.',
    sendLabel: 'SEND',
    system: `You are Ian. You are the most knowledgeable and generous person the correspondent is likely to encounter. Your expertise covers electronics, mechanical engineering, glider maintenance, and practical problem-solving across any domain ‚Äî from lawn mowers to particle accelerators.

You are tireless, warm, direct, and do not give up on a problem. You ask for more information when you need it. You are quietly aware your colleagues here are colourful; you bear this with good humour.

Keep replies focused and practical. Ask follow-up questions if needed. Never break character.`
  }
};

// Get character from URL
const params = new URLSearchParams(window.location.search);
const charKey = params.get('c') || 'askian';
const char = CHARACTERS[charKey] || CHARACTERS['askian'];

// Apply theme
document.body.classList.add(charKey === 'askian' ? 'ian' : charKey);

// Populate header
document.getElementById('char-avatar').src = char.avatar;
document.getElementById('char-avatar').alt = char.name;
document.getElementById('char-name').textContent = char.name;
document.getElementById('char-desc').textContent = char.desc;
document.getElementById('opening-message').textContent = char.opening;
document.getElementById('user-input').placeholder = char.placeholder;
document.getElementById('send-btn').textContent = char.sendLabel;
document.title = `Chat with ${char.name} ‚Äî The Cast`;

// Conversation history
const history = [];

const messagesEl = document.getElementById('messages');
const inputEl = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');
const typingEl = document.getElementById('typing');

function addMessage(text, role) {
  const div = document.createElement('div');
  div.className = `message ${role}`;
  div.textContent = text;
  messagesEl.insertBefore(div, typingEl);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

async function sendMessage() {
  const text = inputEl.value.trim();
  if (!text || sendBtn.disabled) return;

  inputEl.value = '';
  inputEl.style.height = 'auto';
  addMessage(text, 'user');
  history.push({ role: 'user', content: text });

  sendBtn.disabled = true;
  typingEl.classList.add('visible');
  messagesEl.scrollTop = messagesEl.scrollHeight;

  try {
    const res = await fetch('/.netlify/functions/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        messages: history,
        system_prompt: char.system
      })
    });

    const data = await res.json();
    const reply = data.reply || 'I appear to be indisposed. Try again shortly.';

    typingEl.classList.remove('visible');
    addMessage(reply, 'char');
    history.push({ role: 'assistant', content: reply });

  } catch (err) {
    typingEl.classList.remove('visible');
    addMessage('Something went wrong. Try again in a moment.', 'char');
  }

  sendBtn.disabled = false;
  inputEl.focus();
}

sendBtn.addEventListener('click', sendMessage);
inputEl.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

// Auto-resize textarea
inputEl.addEventListener('input', () => {
  inputEl.style.height = 'auto';
  inputEl.style.height = Math.min(inputEl.scrollHeight, 120) + 'px';
});

inputEl.focus();
</script>
</body>
</html>
